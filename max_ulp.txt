Simulation suggest max ulp = 95 ulp

*** PROVE MAX ULPS = 95 ***

max rel_err = dec_error + 18.7026 + 1/m
max abs_err = (dec_error + 18.7026) m + 1 >= 95
-> To reach 95+ ULP, dec_err >= 94 - 18.7026 = 75.2974 ULP

1e27 = 0.807794 * 2^90
-> If m0 < 0.807794, dec_err <= 2^96/(0.5 * 2^91) = 64 ULP
-> TOO LOW !!!
-> To reach 95+ ULP, m0 >= 0.807794
-> max(dec_err) = 64 / m0 = 64 / 0.807794 = 79.2281 ULP

To calculate m0 upper bound that can reach 95+ ULP:
64 / max(m0) = 75.2974
     max(m0) = 64 / 75.2974 = 0.849963
-> m0 = [0.807794, 0.849963]

### 8 scalings 1e25 branch = 1E-73 x5 + 1e25 x2 + final

m(1E-73) = 0.706739 = 1.413478 / 2
m(1e+25) = 0.516988 = 1.033976 / 2

Scaling 1E-73 x5 + 1E25 x2:
m0 = [0.807794, 0.849963]
m1 = 0.706739 m0 = [0.570900, 0.600702]
m2 = 1.413478 m1 = [0.806954, 0.849079]
m3 = 0.706739 m2 = [0.570306, 0.600077]
m4 = 1.413478 m3 = [0.806115, 0.848196]
m5 = 0.706739 m4 = [0.569713, 0.599453]
m6 = 1.033976 m5 = [0.589069, 0.619820]
m7 = 1.033976 m6 = [0.609083, 0.640879]
                                                        max rel err
rel_err:   dec = 2^96 /(m0 * 2^90) = 64     / m0            79.2281
m1  .2987 + 1.2208 / (0.706739 m0) = 1.7274 / m0 + .2987     2.4371
m2  .2987 + 1.4416 / (0.998960 m0) = 1.4431 / m0 + .2987     2.0852
m3  .2987 + 1.2208 / (0.706004 m0) = 1.7292 / m0 + .2987     2.4393
m4  .2987 + 1.4416 / (0.997921 m0) = 1.4446 / m0 + .2987     2.0870
m5  .2987 + 1.2208 / (0.705270 m0) = 1.7310 / m0 + .2987     2.4416
m6          1.5006 / (0.729232 m0) = 2.0578 / m0             2.5474
m7          1.5006 / (0.754008 m0) = 1.9902 / m0             2.4637
                                    -------------------------------
                     total rel err = 76.123 / m0 + 1.4935   95.7294

Tried to save time by summing the max rel errors.
However, this naive method will have max abs error = 96 ULP

Final:
m8 = m7 * m(last)*(BOT+1)   # BOT+1 adjust m8 low = [0.5, 1)

BRANCH 1E25 final:
last  m(last) BOT+1  m8/m7      m8 low   m8 hi
10    0.625     2    1.25       0.76135  1
100   0.78125   2    1.5625     0.95169  1
1E3   0.97656   1    0.97656    0.59481  0.97656
1E4   0.61035   2    1.2207     0.74351  1
1E5   0.76294   2    1.5259     0.9294   1
1E6   0.95367   1    0.95367    0.58086  0.95367
1E7   0.59605   2    1.1921     0.72609  1
1E8   0.74506   2    1.4901     0.90759  1
1E9   0.93132   1    0.93132    0.56725  0.93132
1E10  0.58208   2    1.1642     0.70909  1
1E11  0.7276    2    1.4552     0.88634  1
1E12  0.90949   1    0.90949    0.55395  0.90949

At last=100, BOTH m8/m7 AND m8 reach maximum

max rel error = 76.123 / m0 + 1.4935 + 1/m8
max abs error = 76.123 m8/m0 + 1.4935 m8 + 1
(last=100)    = 76.123 * m7/m0 * m8/m7 + 1.4935 m8 + 1
              = 76.123 * 0.754008 * 1.5625 + 2.4935
              = 92.177 = 92 ULP

### 8 scalings 1e12 branch = 1E-73 x5 + 1e25 + 1e12 + final

Redo m7 using 1E12:
m6 = [0.589069, 0.619820]
m7 = 0.909495 m6 = [0.535755, 0.563723]
m7 err = 1/m7 = 1/(0.663233 m0) = 1.5078 / m0

BRANCH 1E12 final:
last  m(last) BOT+1  m8/m7      m8 low   m8 hi
10    0.625     2    1.25       0.66969  0.70465
100   0.78125   2    1.5625     0.83712  0.88082
1E3   0.97656   1    0.97656    0.5232   0.55051
1E4   0.61035   2    1.2207     0.654    0.68814
1E5   0.76294   2    1.5259     0.81751  0.86018
1E6   0.95367   1    0.95367    0.51093  0.53761
1E7   0.59605   2    1.1921     0.63867  0.67201
1E8   0.74506   2    1.4901     0.79833  0.84
1E9   0.93132   2    1.86264    0.99792  1
1E10  0.58208   2    1.1642     0.62373  0.65629
1E11  0.7276    2    1.4552     0.77963  0.82033
1E12  0.90949   2    1.81898    0.97453  1

At last=1E9, BOTH m8/m7 AND m8 can reach maximum

max rel err = (1E25 branch) - (1E25 err) + (1E12 err)
            = (76.123 - 1.9902 + 1.5078)/m0 + 1.4935 + 1/m8
            = 75.6406 / m0 + 1.4935 + 1/m8
max abs err = 75.6406 m8/m0 + 1.4935 m8 + 1
(last=1E9)  = 75.6406 * m7/m0 * m8/m7 + 2.4935
            = 75.6406 * 0.663233 * 1.86264 + 2.4935
            = 95.937 = 95 ULP

### 7 scalings or less:

If n >= 0: used 1E60 x4 + 1E25 + 1E12 + final
    max rel_err = 79.2281 + 2.4786 * 4 + 2.9026 + 2 + 1/m
    max abs_err = 94.1051 m + 1 = 95 ULP

    NOTE: If used 1E60 x4 + 1E25 x2 + final, factor >= 1E291
    -> no room for dec error to occur
    -> max abs_err = (2.4786 * 4 + 2.9026*2)(1) + 1 = 16 ULP

If n < 0: used 1E-73 x4 + 1E25 x2 + final
    Reuse above 1E-73 build to m4:
    1E-73 x4 err = 2.4371 + 2.0852 + 2.4393 + 2.0870 = 9.0486
    total rel error = 79.2282 + 9.0486 + 2.9026 * 2 + 1/m
    total abs error = 94.082 m + 1 = 95 ULP

QED
